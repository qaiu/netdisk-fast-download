# API 文档

## API 概览

Netdisk Fast Download 提供了完整的 RESTful API 接口，支持多种调用方式来解析网盘分享链接。

## 基础信息

- **基础URL**: `http://your_host:6400`
- **默认端口**: 6400
- **请求方式**: GET
- **响应格式**: JSON

## 接口类型

### 1. 通用解析接口

#### 直接跳转下载
```
GET /parser?url={分享链接}&pwd={密码}
```

#### JSON格式返回
```
GET /json/parser?url={分享链接}&pwd={密码}
```

### 2. 短链接口

#### 直接跳转下载
```
GET /d/{网盘标识}/{分享key}@{密码}
```

#### JSON格式返回
```
GET /json/{网盘标识}/{分享key}@{密码}
```

### 3. 文件夹解析接口
```
GET /v2/getFileList?url={分享链接}&pwd={密码}
```

### 4. 分享链接详情接口
```
GET /v2/linkInfo?url={分享链接}
```

### 5. 统计信息接口
```
GET /v2/statisticsInfo
```

## 网盘标识对照表

| 网盘名称 | 标识 | 网盘名称 | 标识 |
|---------|------|---------|------|
| 蓝奏云 | lz | 小飞机网盘 | fj |
| 蓝奏云优享 | iz | 亿方云 | fc |
| 奶牛快传 | cow | 123云盘 | ye |
| 移动云云空间 | ec | 文叔叔 | ws |
| 联想乐云 | le | 城通网盘 | ct |
| QQ邮箱中转站 | qq | Cloudreve | ce |
| 超星云盘 | pcx | Google云盘 | pgd |
| OneDrive | pod | Dropbox | pdp |
| iCloud | pic | 网易云音乐 | mnes |
| 酷狗音乐 | mkgs | 酷我音乐 | mkws |
| QQ音乐 | mqqs | | |

## 参数说明

### 通用参数

| 参数名 | 类型 | 必填 | 说明 |
|-------|------|------|------|
| url | string | 是 | 网盘分享链接（建议使用 URL 编码） |
| pwd | string | 否 | 分享密码（如果有的话） |

### 特殊说明

1. **移动云云空间**: 分享key取分享链接中的 `data` 参数
2. **加密分享**: 移动云云空间和小飞机网盘的密码可以忽略
3. **URL编码**: 建议对分享链接进行 URL 编码处理

## 响应格式

### 成功响应

```json
{
  "code": 200,
  "msg": "success",
  "success": true,
  "count": 0,
  "data": {
    "shareKey": "lz:xxx",
    "directLink": "直链下载地址",
    "cacheHit": true,
    "expires": "2024-09-18 01:48:02",
    "expiration": 1726638482825
  },
  "timestamp": 1726637151902
}
```

### 错误响应

```json
{
  "code": 400,
  "msg": "解析失败",
  "success": false,
  "data": null,
  "timestamp": 1726637151902
}
```

## 字段说明

| 字段名 | 类型 | 说明 |
|--------|------|------|
| code | int | 状态码，200为成功 |
| msg | string | 响应消息 |
| success | boolean | 是否成功 |
| shareKey | string | 全局分享key |
| directLink | string | 直链下载地址 |
| cacheHit | boolean | 是否为缓存链接 |
| expires | string | 缓存到期时间 |
| expiration | long | 缓存到期时间戳 |
| timestamp | long | 响应时间戳 |

## 状态码说明

| 状态码 | 说明 |
|--------|------|
| 200 | 解析成功 |
| 400 | 请求参数错误 |
| 404 | 分享链接不存在或已失效 |
| 429 | 请求过于频繁 |
| 500 | 服务器内部错误 |

## 使用限制

1. **频率限制**: 建议控制请求频率，避免被网盘服务商限制
2. **IP限制**: 部分网盘对IP有限制，可能需要配置代理
3. **缓存机制**: 系统会缓存解析结果，默认缓存30分钟
4. **并发限制**: 单个IP建议控制并发请求数量

## 最佳实践

1. **错误处理**: 务必处理各种错误情况
2. **重试机制**: 建议实现指数退避的重试机制
3. **缓存利用**: 合理利用返回的缓存信息
4. **日志记录**: 记录请求日志便于问题排查

::: tip 提示
建议在生产环境中使用 Nginx 等反向代理服务器，并配置适当的缓存策略和限流规则。
:::